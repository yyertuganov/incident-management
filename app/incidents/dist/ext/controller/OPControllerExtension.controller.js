sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/m/MessageToast","sap/ui/model/json/JSONModel"],function(e,t,n){"use strict";const o={N:0,A:1,I:1,H:2,R:3,C:4};return e.extend("ns.incidents.ext.controller.OPControllerExtension",{override:{onInit:function(){const e={text:""};const t=new n(e);this.getView().setModel(t,"dialog")},routing:{onAfterBinding:function(e){const t=this.getView();const s=this.getView().getModel("processsFlowModel").getData();e.requestProperty("status_code").then(function(e){if(e=="H")s.nodes[1].children=["2"];else s.nodes.splice(2,1);s.nodes=s.nodes.filter(t=>t.nodeId<=o[e]);s.nodes[s.nodes.length-1].children=[];let i=new n(s);t.setModel(i,"processNodesModel")})}},editFlow:{onBeforeEdit:function(e){const t=e?.context.getProperty("urgency/descr");return this.openDialog("You're about to edit the incident with Priority: <strong>"+t+"</strong>")},onAfterSave:function(e){e.context.refresh();e.context.requestObject().then(e=>t.show(`Save successful for incident titled: ${e.title}`))},onBeforeDiscard:function(){return this.openDialog("Are you sure you want to discard this draft?")}}},openDialog:function(e){return new Promise(function(t,n){let o=this.getView().getModel("dialog"),s=o.getData();s.text=e;o.setData(s);this.base.getExtensionAPI().loadFragment({name:"ns.incidents.ext.fragment.Dialog",controller:this}).then(function(e){e.getBeginButton().attachPress(function(){e.close();t(null)});e.getEndButton().attachPress(function(){e.close().destroy();n(null)});e.attachAfterClose(function(){e.destroy();n(null)});e.open()})}.bind(this))},closeDialog:function(e){e.getSource().getParent().close()},viewLocation:function(){this.base.getExtensionAPI().loadFragment({name:"ns.incidents.ext.fragment.GeoMap",controller:this}).then(function(e){e.attachEventOnce("afterClose",function(){e.destroy()});e.open()})}})});
//# sourceMappingURL=OPControllerExtension.controller.js.map